FROM balenalib/%%BALENA_MACHINE_NAME%%-node:22-bookworm-slim

# Voor debugging en cache-busting
ENV CACHE_BREAKER=2025-07-09

RUN mkdir /opt/flowfuse-device
RUN npm install -g @flowfuse/device-agent

# COPY device.yml /opt/flowfuse-device/device.yml

COPY entrypoint.sh /usr/src/entrypoint.sh

ENTRYPOINT ["/usr/src/entrypoint.sh"]

CMD ["flowfuse-device-agent"]

